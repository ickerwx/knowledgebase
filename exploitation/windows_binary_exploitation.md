# Windows Binary Exploitation

## DEP Bypass

Windows XP: `bcdedit.exe /set {current} nx AlwaysOff`
Windows 7: `Computer->Settings>Advanced->Startup and Recovery->Edit, edit Boot.ini, change /noexecute=optin to /noexecute=alwaysoff`

We can also disable it via shellcode (http://uninformed.org/?v=2&a=4&t=sumry) with a call to NtSetInformationProcess:
```
ULONG ExecuteFlags = MEM_EXECUTE_OPTION_ENABLE; // 0x2
NtSetInformationProcess(
NtCurrentProcess(), // (HANDLE)-1
ProcessExecuteFlags, // 0x22
&ExecuteFlags, // ptr to 0x2
sizeof(ExecuteFlags)); // 0x4
```

You can WriteProcessMemory -> NtProtectVirtualMemory to make the text section writeable and place your shellcode there (as its executable by default) or just make the stack executable.

Otherwise the classic technqiues are ret2libc and ROP.

## Bypass ASLR

## immunitydbg

### mona

#### Setup
Download from https://github.com/corelan/mona and place the mona.py in Immunitys PyCommands folder. Then issue:

```
`!mona config -set author <name>`
`!mona config -set workingfolder c:\logs\%p`
```

#### Create Egghunter (32-Bit):
`!mona egg -t <tag>`

tags: #windows #exploitation 
